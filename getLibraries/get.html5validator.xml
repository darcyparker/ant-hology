<?xml version="1.0" encoding="UTF-8"?>
<project
  name="ant-hology.getLibraryDefs.html5validator"
  basedir="."
  default="ant-hology.getLibraryDefs.html5validator"
  xmlns:if="ant:if"
  xmlns:unless="ant:unless"
  >

  <dirname property="ant-hology.getLibraryDefs.html5validator.dir" file="${ant.file.ant-hology.getLibraryDefs.html5validator}"/>

  <import file="${ant-hology.dir}/commonProperties.xml" unless:set="ant-hology.commonProperties.loaded"/>
  <import file="${ant-hology.taskdefs.dir}/test.areAllAvailable.xml" unless:set="ant-hology.taskdefs.test.areAllAvailable.loaded"/>
  <import file="${ant-hology.pathdefs.dir}/html5validator.xml" unless:set="ant-hology.pathdefs.html5validator.loaded"/>

  <!-- See http://syntax.whattf.org/ -->
  <!--This is an html5 validator based on relaxng and schematron-->
  <target
    name="ant-hology.get.html5validator"
    description="Installs html5validator library"
    unless="ant-hology.availableLibraries.html5validator">

    <areAllAvailable
      property="ant-hology.availableLibraries.html5validator"
      pathRefId="html5validator.required"
      />

    <sequential
      unless:set="ant-hology.availableLibraries.html5validator"
      >
      <echo>Installing html5validator</echo>
      <delete dir="${ant-hology.lib.dir}/html5validator"/>
      <exec-hg
        dir="${ant-hology.lib.dir}"
        options="clone https://validator@bitbucket.org/validator/syntax html5validator"/>
      <!--Test installation-->
      <areAllAvailable
        property="ant-hology.availableLibraries.html5validator"
        pathRefId="html5validator.required"/>
      <fail message="Installation failed: Some file(s) in path[@refid='html5validator.required'] were not found.">
        <condition>
          <not>
            <isset property="ant-hology.availableLibraries.html5validator"/>
          </not>
        </condition>
      </fail>
      <echo>html5validator was installed successfully.</echo>
    </sequential>
  </target>

  <property name="ant-hology.getLibraryDefs.html5validator.loaded" value="true"/>

</project>
